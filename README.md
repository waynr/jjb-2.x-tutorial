<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-generate-toc again -->
**Table of Contents**

- [JJB 2.x "Tutorial"](#jjb-2x-tutorial)
    - [Set up](#set-up)
        - [Installing](#installing)
        - [Using](#using)
            - [Jenkins Job Builder](#jenkins-job-builder)
        - [Jenkins Manager](#jenkins-manager)
            - [Displaying Generated Jenkins Job XML](#displaying-generated-jenkins-job-xml)
            - [Deploying Generated Jenkins Job to a Jenkins Instance](#deploying-generated-jenkins-job-to-a-jenkins-instance)
    - [Additional Links](#additional-links)

<!-- markdown-toc end -->

# JJB 2.x "Tutorial"

This repo contains:

* The [Libre Office slideshow][ls-rcsqe-2016-01-12] presented at the
[2016-01-12 Rose City Software Quality Engineering][rcsqe-2016-01-12] meetup.
    * [PDF export of the slideshow][pdf-rcsqe-2016-01-12]
* An example
  [Jenkins job pipeline defined using Python code][example_jenkins-manager_pipeline].

## Set up

Because both Jenkins Job Builder 2.x and Jenkins Manager are still under
development, you will have to install both from their respective git
repositories. As soon as a `jenkins-job-builder` 2.0.0 package has been
released, the first version of jenkins-manager will be released and this
tutorial repo will be updated to reflect a more sane installation method.

### Installing

```bash
git clone --branch rcsqe-2016-01-12 http://github.com/waynr/jenkins-manager
cd jenkins-manager
git clone --branch rcsqe-2016-01-12 http://github.com/waynr/jenkins-job-builder
```
Clone each repo using the `rcsqe-2016-01-12` tag to ensure the example in this
tutorial runs agains compatible versions of code. Kind of awful yes, but we will
eventually have proper Pypi packages to install.


```bash
virtualenv .virtualenv && source .virtualenv/bin/activate
```
For anyone unfamiliar with Python development, the steps above will set up a
local virtual environment which can deleted and recreated at will.

```bash
pip install -e jenkins-job-builder
pip install -e ./
```
Install JJB and Jenkins Manager in development mode (any change you make to
either source tree will be reflected in the behavior of the installed
tools/libraries)

### Using

At this point you should have two command line tools available; `jenkins-jobs`
(from jenkins-job-builder) which will enable you to define Jenkins job
configuration using YAML, and `jankman` (from jenkins-manager) which will enable
you to define Jenkins job configuraion using Python code.

#### Jenkins Job Builder

The best source of information for defining Jenkins jobs in YAML using
`jenkins-jobs` is
[Openstack Infra's documentation page](http://docs.openstack.org/infra/jenkins-job-builder/),
which is kept synchronized with the latest release of JJB. It won't quite be in
sync with the in-development JJB 2.x API work, but for the purpose of Jenkins
plugins the support should remain about the same.

This tutorial repo is not intended to discuss JJB YAML at all, please see the
above documentation site to learn more about it.

### Jenkins Manager

Since Jenkins Manager is at the time of this writing less than a week old,
there is no best source of documentation for it--in fact, there is very little
documentation at all so far. As the project matures (assuming there is enough
interest from users to maintain it) and more Jenkins configuration boilerplate
is implemented in its job definition API, its documentation state will also
improve.

To get started experimenting with the example `jenkins-manager` test pipeline,
see the example `jankman` calls below.

#### Displaying Generated Jenkins Job XML

```bash
jankman test examples/jenkins-manager
```

This command will cause all the jobs generated by the
`examples/jenkins-manager/pipeline.py` Python module to be dumped to STDOUT in
your terminal. No Jenkins instance will be updated.

#### Deploying Generated Jenkins Job to a Jenkins Instance

```bash
jankman deploy examples/jenkins-manager
```

This command will cause all the jobs generated by the
`examples/jenkins-manager/pipeline.py` to be deployed to the default Jenkins
URL--the JJB 2.x library by default assumes there is a Jenkins master available
at `localhost:8080`. It is assumed that this Jenkins instance can be accessed
without authentication. If your setup deviates from a default Jenkins instance
seup, you can pass a configuration file to the `jankman` command line tool:

```bash
jankman --conf path/to/config.ini deploy examples/jenkins-manager
```

The values you can set in this configuration file are documented in the JJB
[project documentation](http://docs.openstack.org/infra/jenkins-job-builder/execution.html)


## Additional Links

* [JJB 2.0 API Refactor Gerrit reviews](https://review.openstack.org/#/q/topic:jjb-2.0.0-api)
* [JJB 2.0 API Spec](http://specs.openstack.org/openstack-infra/infra-specs/specs/jenkins-job-builder_2.0.0-api-changes.html#gerrit-topic)


[example_jenkins-manager_pipeline]: examples/jenkins-manager/pipeline.py
[rcsqe-2016-01-12]: http://www.meetup.com/Rose-City-Software-Quality-Engineers/events/227299686/
[ls-rcsqe-2016-01-12]: presentation/version-control-jenkins-jobs-with-jjb.fodp
[pdf-rcsqe-2016-01-12]: http://waynr.github.io/jjb-2.x-tutorial/pdfs/version-control-jenkins-jobs-with-jjb.pdf
